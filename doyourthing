#!/bin/bash

# Terminal color codes
RESET='\033[0m'
BOLD='\033[1m'
REVERSE='\033[7m'
RED='\033[31m'
GREEN='\033[32m'

# Successful/failed package install counts
SUCCESSFUL=0
FAILED=0

# Pass the title of the package as the first parameter and
# the install command as the second one
dyt () {
	printf "Installing ${BOLD}$1${RESET} ...\n"
	
	if $2;
	then
		let "SUCCESSFUL++"
		printf "${GREEN}✓${RESET} ${BOLD}$1${RESET} installed successfully.\n\n"
	else
		let "FAILED++"
		printf "${RED}✗${RESET} ${BOLD}$1${RESET} failed installing.\n\n"
	fi	
}

# Pretty print a section title given as first param
title () {
	printf "${REVERSE}$1${RESET}\n\n"
}

# start from home dir
HOME=/home/milovangudelj

cd $HOME

# dnf utils / config manager
dyt "DNF Utils" "sudo dnf -q -y install dnf-utils 'dnf-command(config-manager)'"

# Skip GRUB menu (boot options)
search="GRUB_TIMEOUT=5"
replace="GRUB_TIMEOUT=0"
sudo sed -i "s/$search/$replace/g" /etc/default/grub
sudo update-grub

# Setup git
git config --global user.name milovangudelj
git config --global user.email milovan.gudelj@gmail.com

# Repo installation section
title "Adding repos..."

# RPM Fusion
sudo dnf -q -y install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm
sudo dnf -q -y install https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm

# NordVPN
sudo rpm -v --import https://repo.nordvpn.com/gpg/nordvpn_public.asc
sudo dnf -q -y config-manager --add-repo https://repo.nordvpn.com/yum/nordvpn/centos

# GitHub CLI
sudo dnf -q -y config-manager --add-repo https://cli.github.com/packages/rpm/gh-cli.repo

# MKVToolNix
sudo rpm -Uhv https://mkvtoolnix.download/fedora/bunkus-org-repo-2-4.noarch.rpm

# Fish Shell
sudo dnf -q -y config-manager --add-repo https://download.opensuse.org/repositories/shells:fish/Fedora_34/shells:fish.repo

# Brave Browser
sudo rpm --import https://brave-browser-rpm-release.s3.brave.com/brave-core.asc
sudo dnf -q -y config-manager --add-repo https://brave-browser-rpm-release.s3.brave.com/x86_64/

# pgAdmin
sudo rpm -i https://ftp.postgresql.org/pub/pgadmin/pgadmin4/yum/pgadmin4-fedora-repo-2-1.noarch.rpm

title "Adding aliases..."

echo "cls, ll, myip"
sudo echo "alias cls=\"clear\"" >> $HOME/.bashrc
sudo echo "alias ll=\"ls -la\"" >> $HOME/.bashrc
sudo echo "alias myip=\"curl ipinfo.io/ip && echo\"" >> $HOME/.bashrc
source $HOME/.bashrc
echo cls done.

title "Installing packages..."

# Gedit
dyt "Gedit" "sudo dnf -q -y install gedit"

# Gnome Tweaks
dyt "Gnome Tweaks" "sudo dnf -q -y install gnome-tweaks"

# Audacity
dyt "Audacity" "sudo dnf -q -y install audacity"

# Snap
echo Snap ...
sudo dnf -q -y install snapd
if [[ ! -L "/snap" ]]; then
	sudo ln -s /var/lib/snapd/snap /snap
fi
echo Snap installed.

# VS Code
dyt "VS Code" "sudo snap install code --classic"

# Node.js
dyt "Node.js" "dnf -q -y module install nodejs:16"

# Sanity CLI
dyt "Sanity CLI" "sudo npm i @sanity/cli -g"

# create-next-app
dyt "create-next-app" "sudo npm i create-next-app -g"

# sass
dyt "sass" "sudo npm i sass -g"

# supabase
dyt "Supabase" "sudo npm i supabase -g"

# ts-node
dyt "ts-node" "sudo npm i ts-node -g"

# Vercel
dyt "Vercel" "sudo npm i vercel -g"

# Spotify
dyt "Spotify" "sudo snap install spotify"

# NordPass
dyt "NordPass" "sudo snap install nordpass"

# NordVPN
dyt "NordVPN" "sudo dnf -q -y install nordvpn"

# GitHub CLI
dyt "GitHub CLI" "sudo dnf -q -y install gh"

# VLC
dyt "VLC" "sudo dnf -q -y install vlc python-vlc"

# HandBrake
dyt "HandBrake" "sudo dnf -q -y install handbrake handbrake-gui"

# Aegisub
dyt "Aegisub" "sudo dnf -q -y install aegisub"

# MKVToolNix
dyt "MKVToolNix" "sudo dnf -q -y install mkvtoolnix mkvtoolnix-gui"

# Fish shell
echo Fish shell
sudo dnf -q -y install fish
sudo echo /usr/local/bin/fish | sudo tee -a /etc/shells
sudo chsh -s /usr/local/bin/fish
echo Fish shell installed.

# uuid
dyt "uuid" "sudo dnf -q -y install uuid"

# WebP
dyt "WebP" "sudo dnf -q -y install libwebp"

# webp-pixbuf-loader
dyt "webp-pixbuf-loader" "sudo dnf -q -y install webp-pixbuf-loader"

# Brave Browser
dyt "Brave Browser" "sudo dnf -q -y install brave-browser"

# Fira Code fonts
dyt "Fira Code fonts" "sudo dnf -q -y install fira-code-fonts"

# OBS Studio
dyt "OBS Studio" "sudo dnf -q -y install kmod-v4l2loopback obs-studio"

# Zoom
echo Zoom ...
cd $HOME/Downloads
wget https://zoom.us/client/latest/zoom_x86_64.rpm
sudo dnf -q -y install zoom_x86_64.rpm
sudo rm zoom_x86_64.rpm
cd $HOME
echo Zoom installed.

# Postman
dyt "Postman" "sudo snap install postman"

# Slack
dyt "Slack" "sudo snap install slack"

# Discord
dyt "Discord" "sudo dnf -q -y install discord"

# MongoDB Compass
echo MongoDB Compass ...
cd $HOME/Downloads
wget https://downloads.mongodb.com/compass/mongodb-compass-1.32.2.x86_64.rpm
sudo dnf -q -y install mongodb-compass-1.32.2.x86_64.rpm
sudo rm mongodb-compass-1.32.2.x86_64.rpm
cd $HOME
echo MongoDB Compass installed.

# postgresql
echo postgresql ...
sudo dnf -q -y module reset postgresql -y
sudo dnf -q -y module enable postgresql:14
sudo dnf -q -y install vim postgresql-server postgresql
echo postgresql installed.

# pgAdmin
echo pgAdmin ...
sudo dnf -q -y install pgadmin4
sudo /usr/pgadmin4/bin/setup-web.sh
echo pgAdmin installed.

# Signal
dyt "Signal" "sudo snap install signal-desktop"

# Viber
echo Viber ...
cd $HOME/Downloads
wget https://download.cdn.viber.com/desktop/Linux/viber.AppImage
sudo chmod +x viber.AppImage
sudo ./viber.AppImage
sudo rm viber.AppImage
cd $HOME
echo Viber installed.

# libreoffice
dyt "libreoffice" "sudo dnf -q -y install libreoffice"

# unrar
dyt "unrar" "sudo dnf -q -y install unrar"

# Java SE 18 Development Kit
echo Java SE 18 Development Kit ...
cd $HOME/Downloads
wget https://download.oracle.com/java/18/latest/jdk-18_linux-x64_bin.rpm
sudo rpm -ivh jdk-18_linux-x64_bin.rpm
sudo rm jdk-18_linux-x64_bin.rpm
cd $HOME
echo Java SE 18 Development Kit installed.

# Kdenlive
dyt "Kdenlive" "sudo dnf -q -y install kdenlive"

# CMake
dyt "CMake" "sudo dnf -q -y install cmake"

# ASCII Art Library
dyt "ASCII Art Library" "sudo dnf -q -y install aalib"

# gphoto2 libgphoto2-devel
dyt "Gphoto" "sudo dnf -q -y install gphoto2 libgphoto2-devel"

# ffmpeg
dyt "FFmpeg" "sudo dnf -q -y install ffmpeg"

# v4l2loopback
dyt "v4l2loopback" "sudo dnf -q -y install v4l2loopback"

# libtool
dyt "libtool" "sudo dnf -q -y install libtool-ltdl-devel"

# xdotool
dyt "xdotool" "sudo dnf -q -y install xdotool"

# wmctrl
dyt "wmctrl" "sudo dnf -q -y install wmctrl"

# RPM publishing utils
dyt "RPM utils" "sudo dnf -q -y install gcc dpkg-dev gpg"

# rpmdevtools
dyt "rpmdevtools" "sudo dnf -q -y install rpmdevtools rpmlint"

# libusb
dyt "libusb" "sudo dnf -q -y install libusb-devel"

# qBittorrent
dyt "qBittorrent" "sudo dnf -q -y install qbittorrent"

# Steam
dyt "Steam" "sudo dnf -q -y install steam"

# The End

printf "Done installing packages and programs!\n"
printf "${GREEN}${SUCCESSFUL}${RESET} installed\n${RED}${FAILED}${RESET} failed\n"